-- XENO Style Sky Changer for Roblox
-- Автор: GitHub
-- Описание: Меняет небо в Roblox на полностью серое при инжекте

local Players = game:GetService("Players")
local Lighting = game:GetService("Lighting")
local TweenService = game:GetService("TweenService")

-- Функция для создания уведомлений
function createNotification(title, text, duration)
    if not _G.XENO_Notifications then
        _G.XENO_Notifications = {}
    end
    
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "XENONotifications"
    screenGui.Parent = game:GetService("CoreGui")
    
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 300, 0, 80)
    frame.Position = UDim2.new(1, -320, 0, 20 + (#_G.XENO_Notifications * 90))
    frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    frame.BorderSizePixel = 0
    frame.Parent = screenGui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = frame
    
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(80, 80, 80)
    stroke.Thickness = 2
    stroke.Parent = frame
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, -20, 0, 25)
    titleLabel.Position = UDim2.new(0, 10, 0, 10)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = title
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 14
    titleLabel.Parent = frame
    
    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.new(1, -20, 0, 40)
    textLabel.Position = UDim2.new(0, 10, 0, 35)
    textLabel.BackgroundTransparency = 1
    textLabel.Text = text
    textLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    textLabel.TextXAlignment = Enum.TextXAlignment.Left
    textLabel.TextYAlignment = Enum.TextYAlignment.Top
    textLabel.Font = Enum.Font.Gotham
    textLabel.TextSize = 12
    textLabel.TextWrapped = true
    textLabel.Parent = frame
    
    table.insert(_G.XENO_Notifications, screenGui)
    
    -- Анимация появления
    frame.Position = UDim2.new(1, 300, 0, frame.Position.Y.Offset)
    local tween = TweenService:Create(frame, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
        Position = UDim2.new(1, -320, 0, frame.Position.Y.Offset)
    })
    tween:Play()
    
    -- Автоматическое закрытие
    delay(duration, function()
        local tweenOut = TweenService:Create(frame, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            Position = UDim2.new(1, 300, 0, frame.Position.Y.Offset)
        })
        tweenOut:Play()
        tweenOut.Completed:Wait()
        screenGui:Destroy()
        
        -- Обновление позиций остальных уведомлений
        for i, notif in ipairs(_G.XENO_Notifications) do
            if notif == screenGui then
                table.remove(_G.XENO_Notifications, i)
                break
            end
        end
    end)
end

-- Функция для создания полностью серых текстур
function createGraySkybox()
    -- Создаем полностью серое небо с разными оттенками серого для реалистичности
    local graySky = Instance.new("Sky")
    graySky.Name = "XENOCompleteGraySky"
    
    -- Используем чистые серые цвета вместо текстур
    -- Для реалистичности используем разные оттенки серого
    
    -- Боковые стороны - темно-серый
    local darkGray = "rbxasset://textures/sky/sky_512_cloudy.dds"
    -- Верх - светло-серый
    local lightGray = "rbxasset://textures/sky/sky_512_cloudy.dds"
    
    -- Альтернативный вариант: создаем програмmatically серые текстуры
    graySky.SkyboxBk = "http://www.roblox.com/asset/?id=1" -- Заменитель серого
    graySky.SkyboxDn = "http://www.roblox.com/asset/?id=1" 
    graySky.SkyboxFt = "http://www.roblox.com/asset/?id=1"
    graySky.SkyboxLf = "http://www.roblox.com/asset/?id=1"
    graySky.SkyboxRt = "http://www.roblox.com/asset/?id=1"
    graySky.SkyboxUp = "http://www.roblox.com/asset/?id=1"
    
    -- Настройка свойств неба
    graySky.SunAngularSize = 0 -- Убираем солнце
    graySky.MoonAngularSize = 0 -- Убираем луну
    
    return graySky
end

-- Функция для создания атмосферного эффекта
function createAtmosphere()
    local atmosphere = Instance.new("Atmosphere")
    atmosphere.Name = "XENOGrayAtmosphere"
    atmosphere.Density = 0.5
    atmosphere.Offset = 0.25
    atmosphere.Color = Color3.fromRGB(120, 120, 120)
    atmosphere.Decay = Color3.fromRGB(140, 140, 140)
    atmosphere.Glare = 0
    atmosphere.Haze = 5
    
    return atmosphere
end

-- Функция для создания серых облаков
function createGrayClouds()
    local clouds = Instance.new("Clouds")
    clouds.Name = "XENOGrayClouds"
    clouds.Cover = 0.8
    clouds.Density = 0.7
    clouds.Color = Color3.fromRGB(150, 150, 150)
    
    return clouds
end

-- Основная функция изменения неба
function changeSkyToGray()
    -- Сохраняем оригинальные настройки
    if not _G.OriginalLightingSettings then
        _G.OriginalLightingSettings = {
            Sky = Lighting:FindFirstChildOfClass("Sky") and Lighting:FindFirstChildOfClass("Sky"):Clone(),
            Atmosphere = Lighting:FindFirstChildOfClass("Atmosphere") and Lighting:FindFirstChildOfClass("Atmosphere"):Clone(),
            Clouds = Lighting:FindFirstChildOfClass("Clouds") and Lighting:FindFirstChildOfClass("Clouds"):Clone(),
            FogColor = Lighting.FogColor,
            FogEnd = Lighting.FogEnd,
            FogStart = Lighting.FogStart,
            Ambient = Lighting.Ambient,
            OutdoorAmbient = Lighting.OutdoorAmbient,
            Brightness = Lighting.Brightness,
            TimeOfDay = Lighting.TimeOfDay,
            GlobalShadows = Lighting.GlobalShadows,
            ColorShift_Bottom = Lighting.ColorShift_Bottom,
            ColorShift_Top = Lighting.ColorShift_Top
        }
    end
    
    -- Очищаем существующие эффекты неба
    local existingSky = Lighting:FindFirstChildOfClass("Sky")
    if existingSky then
        existingSky:Destroy()
    end
    
    local existingAtmosphere = Lighting:FindFirstChildOfClass("Atmosphere")
    if existingAtmosphere then
        existingAtmosphere:Destroy()
    end
    
    local existingClouds = Lighting:FindFirstChildOfClass("Clouds")
    if existingClouds then
        existingClouds:Destroy()
    end
    
    -- Создаем полностью серое небо
    local graySky = createGraySkybox()
    graySky.Parent = Lighting
    
    -- Создаем серую атмосферу
    local grayAtmosphere = createAtmosphere()
    grayAtmosphere.Parent = Lighting
    
    -- Создаем серые облака
    local grayClouds = createGrayClouds()
    grayClouds.Parent = Lighting
    
    -- Комплексная настройка освещения для полностью серой атмосферы
    Lighting.FogColor = Color3.fromRGB(90, 90, 90)        -- Серый туман
    Lighting.FogEnd = 1500
    Lighting.FogStart = 100
    Lighting.Ambient = Color3.fromRGB(70, 70, 70)         -- Серое окружающее освещение
    Lighting.OutdoorAmbient = Color3.fromRGB(90, 90, 90)  -- Серое наружное освещение
    Lighting.Brightness = 1.2                             -- Умеренная яркость
    Lighting.TimeOfDay = "12:00:00"                       -- Полдень для равномерного света
    Lighting.GlobalShadows = true
    Lighting.ColorShift_Bottom = Color3.fromRGB(100, 100, 100) -- Серый цветовой сдвиг
    Lighting.ColorShift_Top = Color3.fromRGB(120, 120, 120)
    
    -- Дополнительные настройки для полного контроля
    Lighting.ExposureCompensation = 0.1                   -- Компенсация экспозиции
    
    -- Убираем цветовые эффекты
    if Lighting:FindFirstChild("ColorCorrection") then
        Lighting.ColorCorrection:Destroy()
    end
    
    if Lighting:FindFirstChild("BloomEffect") then
        Lighting.BloomEffect:Destroy()
    end
    
    if Lighting:FindFirstChild("BlurEffect") then
        Lighting.BlurEffect:Destroy()
    end
    
    createNotification("XENO SKY CHANGER", "Небо полностью изменено на серое!", 5)
end

-- Улучшенная функция восстановления оригинального неба
function restoreOriginalSky()
    if _G.OriginalLightingSettings then
        -- Очищаем наши эффекты
        local ourSky = Lighting:FindFirstChild("XENOCompleteGraySky")
        if ourSky then
            ourSky:Destroy()
        end
        
        local ourAtmosphere = Lighting:FindFirstChild("XENOGrayAtmosphere")
        if ourAtmosphere then
            ourAtmosphere:Destroy()
        end
        
        local ourClouds = Lighting:FindFirstChild("XENOGrayClouds")
        if ourClouds then
            ourClouds:Destroy()
        end
        
        -- Восстанавливаем оригинальное небо
        if _G.OriginalLightingSettings.Sky then
            _G.OriginalLightingSettings.Sky:Clone().Parent = Lighting
        end
        
        -- Восстанавливаем атмосферу
        if _G.OriginalLightingSettings.Atmosphere then
            _G.OriginalLightingSettings.Atmosphere:Clone().Parent = Lighting
        end
        
        -- Восстанавливаем облака
        if _G.OriginalLightingSettings.Clouds then
            _G.OriginalLightingSettings.Clouds:Clone().Parent = Lighting
        end
        
        -- Восстанавливаем настройки освещения
        Lighting.FogColor = _G.OriginalLightingSettings.FogColor
        Lighting.FogEnd = _G.OriginalLightingSettings.FogEnd
        Lighting.FogStart = _G.OriginalLightingSettings.FogStart
        Lighting.Ambient = _G.OriginalLightingSettings.Ambient
        Lighting.OutdoorAmbient = _G.OriginalLightingSettings.OutdoorAmbient
        Lighting.Brightness = _G.OriginalLightingSettings.Brightness
        Lighting.TimeOfDay = _G.OriginalLightingSettings.TimeOfDay
        Lighting.GlobalShadows = _G.OriginalLightingSettings.GlobalShadows
        Lighting.ColorShift_Bottom = _G.OriginalLightingSettings.ColorShift_Bottom
        Lighting.ColorShift_Top = _G.OriginalLightingSettings.ColorShift_Top
        
        createNotification("XENO SKY CHANGER", "Оригинальное небо восстановлено!", 5)
    else
        createNotification("XENO SKY CHANGER", "Оригинальные настройки не найдены!", 5)
    end
end

-- Функция для принудительного серого неба (максимальный эффект)
function forceGraySky()
    -- Удаляем все эффекты неба
    for _, obj in ipairs(Lighting:GetChildren()) do
        if obj:IsA("Sky") or obj:IsA("Atmosphere") or obj:IsA("Clouds") then
            obj:Destroy()
        end
    end
    
    -- Устанавливаем минималистичное серое небо
    local minimalSky = Instance.new("Sky")
    minimalSky.Name = "XENOMinimalGraySky"
    
    -- Используем базовые серые текстуры
    minimalSky.SkyboxBk = "rbxasset://textures/sky/sky_512_cloudy.dds"
    minimalSky.SkyboxDn = "rbxasset://textures/sky/sky_512_cloudy.dds"
    minimalSky.SkyboxFt = "rbxasset://textures/sky/sky_512_cloudy.dds"
    minimalSky.SkyboxLf = "rbxasset://textures/sky/sky_512_cloudy.dds"
    minimalSky.SkyboxRt = "rbxasset://textures/sky/sky_512_cloudy.dds"
    minimalSky.SkyboxUp = "rbxasset://textures/sky/sky_512_cloudy.dds"
    
    minimalSky.Parent = Lighting
    
    -- Максимально серые настройки
    Lighting.FogColor = Color3.fromRGB(80, 80, 80)
    Lighting.Ambient = Color3.fromRGB(60, 60, 60)
    Lighting.OutdoorAmbient = Color3.fromRGB(80, 80, 80)
    Lighting.Brightness = 1.0
    Lighting.TimeOfDay = "12:00:00"
    
    createNotification("XENO SKY CHANGER", "Принудительное серое небо применено!", 5)
end

-- Создаем GUI для управления
function createControlGUI()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "XENOSkyControl"
    screenGui.Parent = game:GetService("CoreGui")
    
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 280, 0, 200)
    mainFrame.Position = UDim2.new(0, 20, 0, 20)
    mainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = screenGui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = mainFrame
    
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(80, 80, 80)
    stroke.Thickness = 2
    stroke.Parent = mainFrame
    
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 40)
    title.Position = UDim2.new(0, 0, 0, 0)
    title.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    title.BorderSizePixel = 0
    title.Text = "RNS gray sky"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.Font = Enum.Font.GothamBold
    title.TextSize = 16
    title.Parent = mainFrame
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 8)
    titleCorner.Parent = title
    
    local graySkyBtn = Instance.new("TextButton")
    graySkyBtn.Size = UDim2.new(0.8, 0, 0, 35)
    graySkyBtn.Position = UDim2.new(0.1, 0, 0, 50)
    graySkyBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    graySkyBtn.BorderSizePixel = 0
    graySkyBtn.Text = "Gray SKY"
    graySkyBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    graySkyBtn.Font = Enum.Font.Gotham
    graySkyBtn.TextSize = 14
    graySkyBtn.Parent = mainFrame
    
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 6)
    btnCorner.Parent = graySkyBtn
    
    local forceGrayBtn = Instance.new("TextButton")
    forceGrayBtn.Size = UDim2.new(0.8, 0, 0, 35)
    forceGrayBtn.Position = UDim2.new(0.1, 0, 0, 95)
    forceGrayBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    forceGrayBtn.BorderSizePixel = 0
    forceGrayBtn.Text = "Принудительное Серое"
    forceGrayBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    forceGrayBtn.Font = Enum.Font.Gotham
    forceGrayBtn.TextSize = 12
    forceGrayBtn.Parent = mainFrame
    
    local forceCorner = Instance.new("UICorner")
    forceCorner.CornerRadius = UDim.new(0, 6)
    forceCorner.Parent = forceGrayBtn
    
    local restoreBtn = Instance.new("TextButton")
    restoreBtn.Size = UDim2.new(0.8, 0, 0, 35)
    restoreBtn.Position = UDim2.new(0.1, 0, 0, 140)
    restoreBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    restoreBtn.BorderSizePixel = 0
    restoreBtn.Text = "Restarting SKY"
    restoreBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    restoreBtn.Font = Enum.Font.Gotham
    restoreBtn.TextSize = 14
    restoreBtn.Parent = mainFrame
    
    local restoreCorner = Instance.new("UICorner")
    restoreCorner.CornerRadius = UDim.new(0, 6)
    restoreCorner.Parent = restoreBtn
    
    -- Обработчики событий
    graySkyBtn.MouseButton1Click:Connect(function()
        changeSkyToGray()
    end)
    
    forceGrayBtn.MouseButton1Click:Connect(function()
        forceGraySky()
    end)
    
    restoreBtn.MouseButton1Click:Connect(function()
        restoreOriginalSky()
    end)
    
    -- Эффекты при наведении
    local function setupButtonHover(button, normalColor, hoverColor)
        button.MouseEnter:Connect(function()
            button.BackgroundColor3 = hoverColor
        end)
        
        button.MouseLeave:Connect(function()
            button.BackgroundColor3 = normalColor
        end)
    end
    
    setupButtonHover(graySkyBtn, Color3.fromRGB(60, 60, 60), Color3.fromRGB(70, 70, 70))
    setupButtonHover(forceGrayBtn, Color3.fromRGB(50, 50, 50), Color3.fromRGB(60, 60, 60))
    setupButtonHover(restoreBtn, Color3.fromRGB(80, 80, 80), Color3.fromRGB(90, 90, 90))
    
    return screenGui
end

-- Основная функция инициализации
function initialize()
    createNotification("RNS GRAY SKY", "Скрипт полностью серого неба загружен!", 3)
    
    wait(1)
    
    local controlGUI = createControlGUI()
    
    -- Автоматически применяем серое небо при запуске
    changeSkyToGray()
    
    createNotification("XENO GRAY SKY", "Готов к работе! Используйте панель управления.", 5)
end

-- Запуск скрипта
if game:GetService("RunService"):IsClient() then
    initialize()
else
    createNotification("Ошибка", "Скрипт должен быть запущен на клиенте!", 5)
end
